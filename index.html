<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü¶û Stock Research</title>
    <link rel="stylesheet" href="style.css?v=2">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>ü¶û Stock Research</h1>
                <span id="version" class="version">v2.0.0</span>
            </div>
            <form id="searchForm">
                <div class="search-container">
                    <div class="input-wrapper">
                        <input 
                            type="text" 
                            id="tickerInput" 
                            placeholder="Search ticker or company name..." 
                            autocomplete="off"
                        >
                        <div class="input-spinner hidden" id="inputSpinner">
                            <div class="spinner-ring"></div>
                        </div>
                        <div class="input-underline"></div>
                        <div class="input-underline-focus"></div>
                    </div>
                    <div id="searchSuggestions" class="suggestions hidden"></div>
                </div>
                <button type="submit" id="searchBtn">
                    <span class="btn-text">Search</span>
                    <span class="btn-spinner hidden">
                        <div class="spinner-ring"></div>
                    </span>
                </button>
            </form>
        </header>

        <main id="main">
            <div id="loading" class="loading hidden">
                <!-- Progress Bar -->
                <div class="progress-container">
                    <div class="progress-bar" id="loadingProgress">
                        <div class="progress-fill"></div>
                    </div>
                    <div class="progress-steps">
                        <span class="progress-step active" data-step="1">Fetching stock data...</span>
                        <span class="progress-step" data-step="2">Loading price history...</span>
                        <span class="progress-step" data-step="3">Rendering charts...</span>
                    </div>
                </div>
                
                <!-- Rotating Stock Tips -->
                <div class="stock-tips-container">
                    <div class="stock-tip" id="stockTip">
                        <span class="tip-icon">üí°</span>
                        <span class="tip-text">Did you know? The P/E ratio helps compare valuations across companies.</span>
                    </div>
                </div>
                
                <!-- Skeleton Header -->
                <div class="card company-header skeleton">
                    <div class="company-header-content">
                        <div>
                            <div class="skeleton-text skeleton-title"></div>
                            <div class="skeleton-text skeleton-subtitle"></div>
                        </div>
                        <div class="skeleton-button"></div>
                    </div>
                </div>
                
                <!-- Skeleton Tabs -->
                <div class="skeleton-tabs">
                    <div class="skeleton-tab"></div>
                    <div class="skeleton-tab"></div>
                    <div class="skeleton-tab"></div>
                    <div class="skeleton-tab"></div>
                </div>
                
                <!-- Skeleton Cards -->
                <div class="card skeleton">
                    <div class="skeleton-text skeleton-heading"></div>
                    <div class="skeleton-grid">
                        <div class="skeleton-metric">
                            <div class="skeleton-text skeleton-label"></div>
                            <div class="skeleton-text skeleton-value"></div>
                        </div>
                        <div class="skeleton-metric">
                            <div class="skeleton-text skeleton-label"></div>
                            <div class="skeleton-text skeleton-value"></div>
                        </div>
                        <div class="skeleton-metric">
                            <div class="skeleton-text skeleton-label"></div>
                            <div class="skeleton-text skeleton-value"></div>
                        </div>
                        <div class="skeleton-metric">
                            <div class="skeleton-text skeleton-label"></div>
                            <div class="skeleton-text skeleton-value"></div>
                        </div>
                    </div>
                </div>
                
                <div class="card skeleton">
                    <div class="skeleton-text skeleton-heading"></div>
                    <div class="skeleton-chart"></div>
                </div>
                
                <div class="card skeleton">
                    <div class="skeleton-text skeleton-heading"></div>
                    <div class="skeleton-grid">
                        <div class="skeleton-metric">
                            <div class="skeleton-text skeleton-label"></div>
                            <div class="skeleton-text skeleton-value"></div>
                        </div>
                        <div class="skeleton-metric">
                            <div class="skeleton-text skeleton-label"></div>
                            <div class="skeleton-text skeleton-value"></div>
                        </div>
                        <div class="skeleton-metric">
                            <div class="skeleton-text skeleton-label"></div>
                            <div class="skeleton-text skeleton-value"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="error" class="error hidden">
                <div class="error-icon">‚ö†Ô∏è</div>
                <p id="errorMessage"></p>
                <div id="retryCountdown" class="retry-countdown hidden">
                    Retrying in <span class="countdown-seconds">3</span>s...
                </div>
                <button id="retryBtn" class="retry-btn">Try Again</button>
            </div>

            <div id="empty" class="empty">
                <div class="empty-illustration">
                    <svg viewBox="0 0 120 120" class="chart-doodle">
                        <path class="doodle-line" d="M10,100 L30,80 L50,90 L70,60 L90,70 L110,30" />
                        <circle class="doodle-dot" cx="30" cy="80" r="4" />
                        <circle class="doodle-dot" cx="50" cy="90" r="4" />
                        <circle class="doodle-dot" cx="70" cy="60" r="4" />
                        <circle class="doodle-dot" cx="90" cy="70" r="4" />
                        <circle class="doodle-dot" cx="110" cy="30" r="4" />
                    </svg>
                </div>
                <h3 class="empty-title">Discover Your Next Investment</h3>
                <p class="empty-description">Search for any stock ticker to access real-time data, interactive charts, and comprehensive financial metrics.</p>
                
                <div class="trending-stocks">
                    <span class="trending-label">Trending Now</span>
                    <div class="trending-grid">
                        <button class="trending-stock" data-ticker="TSLA">
                            <span class="trending-ticker">TSLA</span>
                            <span class="trending-name">Tesla</span>
                        </button>
                        <button class="trending-stock" data-ticker="AAPL">
                            <span class="trending-ticker">AAPL</span>
                            <span class="trending-name">Apple</span>
                        </button>
                        <button class="trending-stock" data-ticker="NVDA">
                            <span class="trending-ticker">NVDA</span>
                            <span class="trending-name">NVIDIA</span>
                        </button>
                        <button class="trending-stock" data-ticker="MSFT">
                            <span class="trending-ticker">MSFT</span>
                            <span class="trending-name">Microsoft</span>
                        </button>
                        <button class="trending-stock" data-ticker="AMZN">
                            <span class="trending-ticker">AMZN</span>
                            <span class="trending-name">Amazon</span>
                        </button>
                        <button class="trending-stock" data-ticker="GOOGL">
                            <span class="trending-ticker">GOOGL</span>
                            <span class="trending-name">Alphabet</span>
                        </button>
                    </div>
                </div>
                
                <!-- Feature Callouts -->
                <div class="feature-callouts">
                    <div class="feature-item">
                        <span class="feature-icon">üìä</span>
                        <span class="feature-text">Real-time Charts</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üí∞</span>
                        <span class="feature-text">Financial Metrics</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üìà</span>
                        <span class="feature-text">Earnings Data</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">‚ö°</span>
                        <span class="feature-text">Live Prices</span>
                    </div>
                </div>
                
                <p class="data-source">Data provided by Polygon.io and Finnhub</p>
            </div>

            <div id="results" class="hidden">
                <!-- Header with company name and refresh -->
                <div class="card company-header">
                    <div class="company-header-content">
                        <div>
                            <h2 id="companyName"></h2>
                            <span id="companyTicker" class="ticker"></span>
                        </div>
                        <button id="refreshBtn" class="refresh-btn" title="Refresh data">
                            <span class="refresh-icon">‚Üª</span>
                            <span class="refresh-text">Refresh</span>
                            <span class="refresh-spinner hidden">
                                <div class="spinner-ring"></div>
                            </span>
                        </button>
                    </div>
                </div>

                <!-- Tab Navigation -->
                <div class="tabs">
                    <div class="tab-indicator"></div>
                    <button class="tab-btn active" data-tab="overview">Overview</button>
                    <button class="tab-btn" data-tab="earnings">Earnings</button>
                    <button class="tab-btn" data-tab="financials">Financials</button>
                    <button class="tab-btn" data-tab="valuation">Valuation</button>
                </div>

                <!-- Tab Contents Container -->
                <div class="tab-content-container">
                <!-- Tab Content: Overview -->
                <div id="overview" class="tab-content active">
                    <!-- Key Metrics Grid -->
                    <div class="card metrics-overview metrics-key">
                        <h3>Key Metrics</h3>
                        <div class="metrics-grid-compact metrics-row">
                            <div class="metric" data-trend="neutral" title="What you're paying for each dollar of earnings. Compare to industry peers and historical averages to gauge if the stock is cheap or expensive.">
                                <span class="metric-label">P/E Ratio</span>
                                <div class="metric-value-row">
                                    <div class="metric-value-container">
                                        <span id="peRatio" class="metric-value"></span>
                                        <span class="metric-trend"></span>
                                    </div>
                                    <canvas class="sparkline" id="peSparkline" width="60" height="20"></canvas>
                                </div>
                            </div>
                            <div class="metric" data-trend="neutral" title="Year-over-year growth in revenue. Shows whether the business is expanding. Top-line growth is harder to fake than earnings.">
                                <span class="metric-label">Revenue Growth (YoY)</span>
                                <div class="metric-value-row">
                                    <div class="metric-value-container">
                                        <span id="revenueGrowth" class="metric-value"></span>
                                        <span class="metric-trend"></span>
                                    </div>
                                    <canvas class="sparkline" id="revenueSparkline" width="60" height="20"></canvas>
                                </div>
                            </div>
                            <div class="metric" data-trend="neutral" title="Cash left after running the business and capital expenditures. Available for dividends, buybacks, debt reduction, or reinvestment. More reliable than net income.">
                                <span class="metric-label">Free Cash Flow</span>
                                <div class="metric-value-row">
                                    <div class="metric-value-container">
                                        <span id="freeCashFlow" class="metric-value"></span>
                                        <span class="metric-trend"></span>
                                    </div>
                                    <canvas class="sparkline" id="fcfSparkline" width="60" height="20"></canvas>
                                </div>
                            </div>
                            <div class="metric" data-trend="neutral" title="How leveraged the company is. High debt amplifies returns in good times but can be fatal in downturns. Shows financial risk and flexibility.">
                                <span class="metric-label">Debt-to-Equity</span>
                                <div class="metric-value-container">
                                    <span id="debtToEquity" class="metric-value"></span>
                                    <span class="metric-trend"></span>
                                </div>
                            </div>
                            <div class="metric" data-trend="neutral" title="How effectively management converts shareholder capital into profits. Consistently high ROE (15%+) often signals a durable competitive advantage.">
                                <span class="metric-label">Return on Equity</span>
                                <div class="metric-value-container">
                                    <span id="roe" class="metric-value"></span>
                                    <span class="metric-trend"></span>
                                </div>
                            </div>
                            <div class="metric" data-trend="neutral" title="Net income as a percentage of revenue. Shows how much profit the company keeps from each dollar of sales.">
                                <span class="metric-label">Profit Margin</span>
                                <div class="metric-value-container">
                                    <span id="profitMargin" class="metric-value"></span>
                                    <span class="metric-trend"></span>
                                </div>
                            </div>
                            <div class="metric" data-trend="neutral" title="Operating income as a percentage of revenue. Measures efficiency of core business operations.">
                                <span class="metric-label">Operating Margin</span>
                                <div class="metric-value-container">
                                    <span id="operatingMargin" class="metric-value"></span>
                                    <span class="metric-trend"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Price Chart -->
                    <div class="card chart-container">
                        <h3>Stock Price History</h3>
                        <div class="chart-wrapper">
                            <canvas id="priceChart"></canvas>
                        </div>
                    </div>

                    <!-- Market Data -->
                    <div class="card metrics-overview metrics-market">
                        <h3>Market Data</h3>
                        <div class="metrics-grid-compact">
                            <div class="metric" title="52-week high. The highest price in the past year.">
                                <span class="metric-label">52W High</span>
                                <span id="price52wHigh" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="52-week low. The lowest price in the past year.">
                                <span class="metric-label">52W Low</span>
                                <span id="price52wLow" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Position in 52-week range. Shows where current price sits relative to yearly high and low.">
                                <span class="metric-label">52W Position</span>
                                <span id="price52wPosition" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Beta. Measures volatility relative to market. > 1 means more volatile than S&P 500.">
                                <span class="metric-label">Beta</span>
                                <span id="beta" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Average daily trading volume. Higher volume means better liquidity.">
                                <span class="metric-label">Avg Volume</span>
                                <span id="avgVolume" class="metric-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Earnings -->
                <div id="earnings" class="tab-content">
                    <div class="card">
                        <h3>EPS: Actual vs Estimated</h3>
                        <canvas id="epsChart" width="800" height="350"></canvas>
                    </div>
                    
                    <!-- Profitability Metrics -->
                    <div class="card metrics-overview metrics-profitability">
                        <h3>Profitability</h3>
                        <div class="metrics-grid-compact">
                            <div class="metric" title="Gross profit margin. Percentage of revenue left after cost of goods sold. Shows pricing power and production efficiency.">
                                <span class="metric-label">Gross Margin</span>
                                <span id="grossMargin" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="EBITDA margin. Earnings before interest, taxes, depreciation. Shows operating profitability.">
                                <span class="metric-label">EBITDA Margin</span>
                                <span id="ebitdaMargin" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Return on Assets. How efficiently the company uses its assets to generate profit.">
                                <span class="metric-label">Return on Assets</span>
                                <span id="roa" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Return on Invested Capital. Measures return to all investors (debt + equity). ROIC > WACC creates value.">
                                <span class="metric-label">ROIC</span>
                                <span id="roic" class="metric-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Financials -->
                <div id="financials" class="tab-content">
                    <div class="card">
                        <h3>Revenue by Quarter</h3>
                        <canvas id="revenueChart" width="800" height="300"></canvas>
                    </div>
                    <div class="card">
                        <h3>Free Cash Flow</h3>
                        <canvas id="fcfChart" width="800" height="300"></canvas>
                    </div>
                    
                    <!-- Financial Health -->
                    <div class="card metrics-overview metrics-health">
                        <h3>Financial Health</h3>
                        <div class="metrics-grid-compact">
                            <div class="metric" title="Current Ratio. Current assets divided by current liabilities. > 1.5 suggests good short-term liquidity.">
                                <span class="metric-label">Current Ratio</span>
                                <span id="currentRatio" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Quick Ratio. Current assets minus inventory, divided by liabilities. More conservative liquidity measure.">
                                <span class="metric-label">Quick Ratio</span>
                                <span id="quickRatio" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Interest Coverage. EBIT divided by interest expense. > 3 indicates comfortable debt service ability.">
                                <span class="metric-label">Interest Coverage</span>
                                <span id="interestCoverage" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Total cash and equivalents on the balance sheet.">
                                <span class="metric-label">Cash & Equivalents</span>
                                <span id="cash" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Working capital. Current assets minus current liabilities. Positive means short-term obligations can be met.">
                                <span class="metric-label">Working Capital</span>
                                <span id="workingCapital" class="metric-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Valuation -->
                <div id="valuation" class="tab-content">
                    <div class="card">
                        <h3>P/E Ratio Over Time</h3>
                        <canvas id="peChart" width="800" height="350"></canvas>
                    </div>
                    
                    <!-- Valuation Metrics -->
                    <div class="card metrics-overview metrics-valuation">
                        <h3>Valuation Metrics</h3>
                        <div class="metrics-grid-compact">
                            <div class="metric" title="Price-to-Sales ratio. Useful for valuing growth companies that may not be profitable yet. Lower is generally better.">
                                <span class="metric-label">P/S Ratio</span>
                                <span id="psRatio" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Price-to-Book ratio. Compares market value to book value. < 1 may indicate undervaluation, > 3 often overvalued.">
                                <span class="metric-label">P/B Ratio</span>
                                <span id="pbRatio" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Enterprise Value to EBITDA. Comprehensive valuation metric that accounts for debt. Useful for comparing across capital structures.">
                                <span class="metric-label">EV/EBITDA</span>
                                <span id="evebitda" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Market capitalization. Total value of all outstanding shares.">
                                <span class="metric-label">Market Cap</span>
                                <span id="marketCap2" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Enterprise Value. Market cap plus debt minus cash. Theoretical takeover price.">
                                <span class="metric-label">Enterprise Value</span>
                                <span id="enterpriseValue" class="metric-value">-</span>
                            </div>
                            <div class="metric" title="Shares outstanding. Number of shares held by all shareholders.">
                                <span class="metric-label">Shares Outstanding</span>
                                <span id="sharesOutstanding" class="metric-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>
                </div><!-- End tab-content-container -->
            </div>
        </main>
    </div>

    <!-- Chart Tooltip -->
    <div id="chartTooltip" class="chart-tooltip hidden">
        <div class="tooltip-date"></div>
        <div class="tooltip-value"></div>
    </div>

    <!-- Metric Tooltip -->
    <div id="metricTooltip" class="metric-tooltip hidden">
        <div class="tooltip-title"></div>
        <div class="tooltip-description"></div>
    </div>

    <!-- Full Screen Chart Modal -->
    <div id="chartModal" class="chart-modal hidden">
        <div class="chart-modal-backdrop"></div>
        <div class="chart-modal-content">
            <div class="chart-modal-header">
                <h2 id="chartModalTitle">Stock Price History</h2>
                <button id="closeChartModal" class="close-modal-btn">&times;</button>
            </div>
            <div class="chart-modal-body">
                <canvas id="fullScreenPriceChart" width="1200" height="600"></canvas>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="app.js?v=6"></script>
</body>
</html>
