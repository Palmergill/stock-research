<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart Option 3: D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 8px;
            color: #f8fafc;
        }
        
        .subtitle {
            color: #94a3b8;
            margin-bottom: 32px;
            font-size: 14px;
        }
        
        .card {
            background: linear-gradient(145deg, #1e293b 0%, rgba(30, 41, 59, 0.8) 100%);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        #chart {
            height: 350px;
            width: 100%;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            font-size: 12px;
            color: #e2e8f0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .tooltip-date {
            color: #94a3b8;
            margin-bottom: 4px;
        }
        
        .tooltip-value {
            font-weight: 600;
            color: #f8fafc;
        }
        
        .pros-cons {
            margin-top: 32px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        
        .pros, .cons {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            padding: 16px;
        }
        
        .pros h3 {
            color: #10b981;
            font-size: 14px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .cons h3 {
            color: #ef4444;
            font-size: 14px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        ul {
            list-style: none;
            font-size: 13px;
            color: #94a3b8;
        }
        
        li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
        }
        
        li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 8px;
            color: #64748b;
        }
        
        .nav {
            display: flex;
            gap: 12px;
            margin-bottom: 32px;
        }
        
        .nav a {
            color: #94a3b8;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .nav a:hover, .nav a.active {
            color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Chart Option 3: D3.js</h1>
        <p class="subtitle">Powerful, customizable - full control over every pixel</p>
        
        <div class="nav">
            <a href="chart-option1-chartjs.html">Chart.js</a>
            <a href="chart-option2-apexcharts.html">ApexCharts</a>
            <a href="chart-option3-d3.html" class="active">D3.js</a>
            <a href="chart-option4-custom.html">Custom Canvas</a>
        </div>
        
        <div class="card">
            <div id="chart"></div>
        </div>
        
        <div class="pros-cons">
            <div class="pros">
                <h3>‚úÖ Pros</h3>
                <ul>
                    <li>Unlimited customization</li>
                    <li>Full control over rendering</li>
                    <li>Excellent performance</li>
                    <li>Industry standard</li>
                    <li>Vast ecosystem</li>
                    <li>Data-driven documents</li>
                </ul>
            </div>
            <div class="cons">
                <h3>‚ùå Cons</h3>
                <ul>
                    <li>Steep learning curve</li>
                    <li>More code required</li>
                    <li>Complex API</li>
                    <li>Overkill for simple charts</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        const data = [];
        let price = 405;
        
        for (let i = 0; i < 90; i++) {
            const date = new Date('2025-11-01');
            date.setDate(date.getDate() + i);
            
            price = price + (Math.random() - 0.5) * 10;
            data.push({
                date: date,
                price: price
            });
        }
        
        // Setup
        const margin = { top: 20, right: 50, bottom: 40, left: 60 };
        const container = document.getElementById('chart');
        const width = container.clientWidth - margin.left - margin.right;
        const height = 350 - margin.top - margin.bottom;
        
        // Create SVG
        const svg = d3.select("#chart")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);
        
        // Create tooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip");
        
        // Scales
        const x = d3.scaleTime()
            .domain(d3.extent(data, d => d.date))
            .range([0, width]);
        
        const y = d3.scaleLinear()
            .domain([d3.min(data, d => d.price) * 0.95, d3.max(data, d => d.price) * 1.05])
            .range([height, 0]);
        
        // Line generator
        const line = d3.line()
            .x(d => x(d.date))
            .y(d => y(d.price))
            .curve(d3.curveMonotoneX);
        
        // Area generator
        const area = d3.area()
            .x(d => x(d.date))
            .y0(height)
            .y1(d => y(d.price))
            .curve(d3.curveMonotoneX);
        
        // Gradient
        const defs = svg.append("defs");
        const gradient = defs.append("linearGradient")
            .attr("id", "area-gradient")
            .attr("x1", "0%")
            .attr("y1", "0%")
            .attr("x2", "0%")
            .attr("y2", "100%");
        
        gradient.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", "#10b981")
            .attr("stop-opacity", 0.3);
        
        gradient.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", "#10b981")
            .attr("stop-opacity", 0.02);
        
        // Grid lines
        svg.append("g")
            .attr("class", "grid")
            .selectAll("line")
            .data(y.ticks(5))
            .enter()
            .append("line")
            .attr("x1", 0)
            .attr("x2", width)
            .attr("y1", d => y(d))
            .attr("y2", d => y(d))
            .attr("stroke", "rgba(51, 65, 85, 0.5)")
            .attr("stroke-width", 1);
        
        // Area
        svg.append("path")
            .datum(data)
            .attr("fill", "url(#area-gradient)")
            .attr("d", area);
        
        // Line
        const path = svg.append("path")
            .datum(data)
            .attr("fill", "none")
            .attr("stroke", "#10b981")
            .attr("stroke-width", 2)
            .attr("d", line);
        
        // Animate line
        const totalLength = path.node().getTotalLength();
        path
            .attr("stroke-dasharray", totalLength + " " + totalLength)
            .attr("stroke-dashoffset", totalLength)
            .transition()
            .duration(1500)
            .ease(d3.easeCubicOut)
            .attr("stroke-dashoffset", 0);
        
        // X Axis
        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x)
                .ticks(6)
                .tickFormat(d3.timeFormat("%b %d")))
            .attr("color", "#64748b")
            .select(".domain").remove();
        
        svg.selectAll(".tick line").remove();
        
        // Y Axis
        svg.append("g")
            .call(d3.axisLeft(y)
                .ticks(5)
                .tickFormat(d => `$${d.toFixed(0)}`))
            .attr("color", "#64748b")
            .select(".domain").remove();
        
        svg.selectAll(".tick line").remove();
        
        // Overlay for hover
        const overlay = svg.append("rect")
            .attr("width", width)
            .attr("height", height)
            .attr("fill", "transparent");
        
        // Hover line
        const hoverLine = svg.append("line")
            .attr("stroke", "rgba(148, 163, 184, 0.6)")
            .attr("stroke-width", 1)
            .attr("y1", 0)
            .attr("y2", height)
            .style("opacity", 0);
        
        // Hover circle
        const hoverCircle = svg.append("circle")
            .attr("r", 5)
            .attr("fill", "#10b981")
            .attr("stroke", "#fff")
            .attr("stroke-width", 2)
            .style("opacity", 0);
        
        // Bisector
        const bisectDate = d3.bisector(d => d.date).left;
        
        overlay.on("mousemove", function(event) {
            const [mx] = d3.pointer(event);
            const x0 = x.invert(mx);
            const i = bisectDate(data, x0, 1);
            const d0 = data[i - 1];
            const d1 = data[i];
            const d = x0 - d0.date > d1.date - x0 ? d1 : d0;
            
            const cx = x(d.date);
            const cy = y(d.price);
            
            hoverLine
                .attr("x1", cx)
                .attr("x2", cx)
                .style("opacity", 1);
            
            hoverCircle
                .attr("cx", cx)
                .attr("cy", cy)
                .style("opacity", 1);
            
            tooltip
                .style("opacity", 1)
                .style("left", (event.pageX + 15) + "px")
                .style("top", (event.pageY - 10) + "px")
                .html(`
                    <div class="tooltip-date">${d3.timeFormat("%b %d, %Y")(d.date)}</div>
                    <div class="tooltip-value">$${d.price.toFixed(2)}</div>
                `);
        })
        .on("mouseleave", function() {
            hoverLine.style("opacity", 0);
            hoverCircle.style("opacity", 0);
            tooltip.style("opacity", 0);
        });
    </script>
</body>
</html>
